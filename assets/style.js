!function(){"use strict";function e(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function t(e,t){n.add(e)}let n=new WeakSet,i=null,l={passive:!1};function o(e){let t;if("button"in e){if(0!==e.button)return;t=null}else{let n=e.touches;if(1!==n.length)return;t=n[0]}null!==i&&i.element.isConnected?a(null):u();let o=e.target;for(;null!==o;){if(n.has(o)){let n=null===t?d("red.argon.mouseDown",e,null):d("red.argon.mouseDown",e,null,t);if(o.dispatchEvent(n),!n.defaultPrevented){i={element:o,touchIdentifier:null===t?null:t.identifier,lastEvent:n},e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",s,l),window.addEventListener("touchmove",s,l),window.addEventListener("mouseup",r,l),window.addEventListener("touchend",r,l),window.addEventListener("touchcancel",r,l);break}}o=o.parentElement}}function s(e){if(null!==i){if(!i.element.isConnected)return u();if(e.preventDefault(),e.stopPropagation(),"button"in e)if(1&e.buttons){let t=d("red.argon.mouseDragged",e,i.lastEvent);i.element.dispatchEvent(t),i.lastEvent=t}else a(e);else{for(let t of e.touches){if(t.identifier!==i.touchIdentifier)continue;let n=d("red.argon.mouseDragged",e,i.lastEvent,t);return i.element.dispatchEvent(n),void(i.lastEvent=n)}a(null)}}}function r(e){if(null!==i){if(!i.element.isConnected)return u();if(e.preventDefault(),e.stopPropagation(),"button"in e)1&e.buttons||a(e);else{for(let t of e.touches)if(t.identifier===i.touchIdentifier)return;a(null)}}}function a(e){let t=d("red.argon.mouseUp",null===e?i.lastEvent:e,i.lastEvent);i.element.dispatchEvent(t),u()}function u(e){window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",s),window.removeEventListener("mouseup",r),window.removeEventListener("touchend",r),window.removeEventListener("touchcancel",r),i=null}function d(e,t,n,i){let l=void 0===i?t:i,o=new MouseEvent(e,{cancelable:!0,bubbles:!1,view:t.view,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,button:0,buttons:"red.argon.mouseUp"===e?0:1,movementX:null===n?0:l.screenX-n.screenX,movementY:null===n?0:l.screenY-n.screenY,clientX:l.clientX,clientY:l.clientY,screenX:l.screenX,screenY:l.screenY});return o.leafTarget="leafTarget"in t?t.leafTarget:t.target,o}if(window.addEventListener("mousedown",o,l),window.addEventListener("touchstart",o,l),"ResizeObserver"in window){new ResizeObserver(h).observe(document.documentElement)}else window.addEventListener("resize",h),window.addEventListener("orientationchange",h);document.addEventListener("load",()=>{requestAnimationFrame(h)},!0),"complete"===document.readyState&&h();let c=!1;function h(){c||(c=!0,m(()=>{c=!1;let e=new Event("red.argon.pageLayout");window.dispatchEvent(e)}))}const m="queueMicrotask"in window?queueMicrotask:"Promise"in window?function(e){Promise.resolve().then(e)}:function(e){setTimeout(e,0)};let f=null,p=null;function g(){let e=document.documentElement.scrollHeight,t=document.documentElement.clientHeight,n=document.documentElement.scrollTop/Math.min(t,e-t);if(f.style.opacity=Math.max(0,1-1.1*n).toString(),p)for(let e of p)e.style.opacity=Math.max(0,1-2*n).toString()}function w(){let e=document.querySelector(".hero-title");if(null===e)return;let t=document.documentElement.clientHeight,n=e.getBoundingClientRect().bottom-document.documentElement.getBoundingClientRect().top,i=f.offsetHeight;f.style.marginTop=Math.max(0,t-n-2*i)+"px",g()}function v(e,t,n){let i=document.querySelector(".footnotes");if(null===i)return;let l=e-t-3.5*n,o=t+Math.max(2.5*n,Math.floor(.1*l)),s=.8125*n,r=Math.floor(l/s);r<14?(l=0,i.classList.remove("all-sidenotes")):(r=Math.min(r,22),l=r*s,i.classList.add("all-sidenotes"));let a=0,u=i.querySelectorAll('li[id^="fn"]');for(let e of u){if(0===l){e.classList.remove("sidenote"),e.removeAttribute("style");continue}let t=a,n=e.querySelector("a.footnote-backref");if(null!==n){let e=document.querySelector(n.hash);null!==e&&(t=Math.max(t,e.getBoundingClientRect().top+window.scrollY))}e.classList.add("sidenote"),e.style.top=t+"px",e.style.left=o+"px",e.style.width=l+"px",a=t+e.offsetHeight}}function y(e,t){let n,i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),l=null;for(;(n=i.nextNode())||null!==l;){if(null!==l){let e=t(l);switch(!0){case null===e||""===e:l.remove();break;case"string"==typeof e:l.data=e;break;case e instanceof Node:l.replaceWith(e)}}l=n}}e(()=>{f=document.querySelector(".hero-chevron-up"),p=document.querySelectorAll(".nav-list .fly"),null!==f&&(window.addEventListener("scroll",g),w())});let b=new WeakMap;function L(e,n,i,l){let o="h"===i[0],s=b.get(e);if(void 0===s){let t=[null,null],n=function(e,t){let n=null;return()=>{null===n&&(n=requestAnimationFrame(()=>{n=null;for(let n of t){if(null===n)continue;let t=E(e,n);for(let e of n.knobs){if(t[0]===t[1]&&0===t[2]){e.style.visibility="hidden";continue}let i=e.parentElement,l=n.hori?i.clientWidth:i.clientHeight,{translate:o,size:s}=S(t,l);e.style.visibility="",n.hori?(e.style.left=o+"px",e.style.width=s+"px"):(e.style.top=o+"px",e.style.height=s+"px")}}}))}}(e,t);b.set(e,s={axes:t,update:n}),e.addEventListener("scroll",s.update,{passive:!0}),e.addEventListener("wheel",s.update,{passive:!0}),e.addEventListener("touchmove",s.update,{passive:!0})}let r=s.axes[o?0:1];null===r&&(s.axes[o?0:1]=r={hori:o,knobs:new Set,inset:void 0===l?null:l}),r.knobs.add(n);let a=n.parentElement;t(a);let u=function(e,t,n){let i=0,l=0,o=0;return s=>{switch(s.type){case"red.argon.mouseDown":let r=e.getBoundingClientRect(),a=n.hori?r.x:r.y,u=E(t,n);o=u[0]-u[1];let d=n.hori?e.clientWidth:e.clientHeight,{translate:c,size:h}=S(u,d);i=a+h/2,l=a+d-h/2;let m=a+c+h/2-(n.hori?s.clientX:s.clientY);if(Math.abs(m)<h/2){i-=m,l-=m;break}case"red.argon.mouseDragged":case"red.argon.mouseUp":let f=((n.hori?s.clientX:s.clientY)-i)/(l-i)*o;n.hori?t.scrollLeft=f:t.scrollTop=f}}}(a,e,r);return a.addEventListener("red.argon.mouseDown",u),a.addEventListener("red.argon.mouseDragged",u),a.addEventListener("red.argon.mouseUp",u),s.update(),s.update}function E(e,t){let n=t.hori?e.scrollWidth:e.scrollHeight,i=t.hori?e.clientWidth:e.clientHeight,l=t.hori?e.scrollLeft:e.scrollTop;if(null!==t.inset){let l=t.inset(e);n-=l,i-=l}return[n,i,l]}function S(e,t){let n,i,[l,o,s]=e;s>=l-o?(n=o/(s+o),i=1):s<=0?(n=o/(l-s),i=0):(n=o/l,i=s/(l-o));let r=Math.min(t,Math.max(20,t*n));return{translate:i*(t-r),size:r}}let T=null;class SlideshowContext{constructor(){this.root=document.createElement("aside"),this.root.className="slideshow",this.root.innerHTML='<div class="slideshow-wrapper"><div class="slideshow-content"><header class="slideshow-header"><button class="slideshow-exit"></button><h1 class="slideshow-title"></h1><div class="slideshow-meta"></div></header><main class="slideshow-body"></main><aside class="slideshow-scroller"><button class="slideshow-scroller-knob"></button></aside></div><img class="slideshow-transimage"></div>',this.wrapper=this.root.querySelector(".slideshow-wrapper"),this.title=this.root.querySelector(".slideshow-title"),this.meta=this.root.querySelector(".slideshow-meta"),this.body=this.root.querySelector(".slideshow-body"),this.transImage=this.root.querySelector(".slideshow-transimage"),this.updateScroller=L(this.body,this.root.querySelector(".slideshow-scroller-knob"),"horizontal",q),this.visibility=0,this.sourceImage=null,this.requestedFrame=null,this.transitionTimer=null,this.endingAction=null;let e=!1,n=-1/0;this.body.addEventListener("wheel",t=>{t.timeStamp-n>80&&(e=Math.abs(t.deltaY)>Math.abs(t.deltaX)),e&&(this.body.scrollLeft+=t.deltaY,t.preventDefault()),n=t.timeStamp});let i=null;t(this.wrapper),this.wrapper.addEventListener("red.argon.mouseDown",e=>{i=null;let t=!0,n=!0,l=e.leafTarget;for(;null!==l&&l!==this.root;){let e=l.classList;if(e.contains("slideshow-exit"))break;if(e.contains("slideshow-title")){n=!1;break}if(e.contains("slideshow-meta")){n=!1;break}if(e.contains("work-slide-image")){n=!1;break}if(e.contains("slideshow-scroller")){n=!1;break}if(!t&&e.contains("work-slide-title")){n=!1;break}l=l.parentElement,t=!1}n?i=[e.screenX,e.screenY]:e.preventDefault()}),this.wrapper.addEventListener("red.argon.mouseUp",e=>{if(null===i)return;let[t,n]=[e.screenX,e.screenY];Math.hypot(t-i[0],n-i[1])<4&&(null!==this.endingAction&&this.endingAction(),this.end(!0))}),this.wrapper.addEventListener("keydown",e=>{"Escape"===e.key&&(e.stopPropagation(),null!==this.endingAction&&this.endingAction(),this.end(!0))}),window.addEventListener("red.argon.pageLayout",this.updateScroller)}begin(e,t,n,i){this.endingAction=i;let l=e.querySelector(".work-entry-image"),o=e.querySelector(".work-entry-title"),s=e.querySelector(".work-entry-meta");switch(this.switchSourceImage(l),this.title.innerHTML=null===o?"":o.innerHTML,this.meta.innerHTML=null===s?"":s.innerHTML,this.body.innerHTML=t.innerHTML,this.visibility){case 0:document.body.appendChild(this.root);case 3:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!n){null!==l&&(l.style.visibility="hidden"),this.visibility=2;break}this.visibility=1,this.root.classList.add("out"),this.requestedFrame=requestAnimationFrame(()=>{this.requestedFrame=null,null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.transitionTimer=setTimeout(()=>{this.root.classList.add("animating"),this.root.classList.remove("out"),this.transformWrapperTo(null),null!==this.sourceImage&&(this.sourceImage.style.visibility="hidden"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.visibility=2},490)},50)});break;case 1:case 2:null!==this.sourceImage&&(this.sourceImage.style.visibility="hidden")}this.updateScroller()}end(e){switch(this.endingAction=null,this.visibility){case 0:case 3:break;case 2:case 1:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!e)return this.switchSourceImage(null),this.visibility=0,void this.root.remove();this.visibility=3,this.root.classList.add("animating"),null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.root.classList.add("out"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.root.classList.remove("out"),this.visibility=0,this.root.remove(),this.transformWrapperTo(null),this.switchSourceImage(null)},450)}}transformWrapperTo(e){if(null===e)return void(this.wrapper.style.transform="");let t=e.getBoundingClientRect(),n=this.transImage.getBoundingClientRect(),i=getComputedStyle(this.wrapper).transform.match(/^matrix\((.+),(.+),(.+),(.+),(.+),(.+)\)$/),[l,o,s,r,a,u]=null===i?[1,0,0,1,0,0]:i.slice(1).map(parseFloat);n={top:n.top/r-u/r,left:n.left/l-a/l,width:n.width/l,height:n.height/r};let d=this.root.getBoundingClientRect(),c=d.left,h=d.top,m=t.width/n.width,f=t.left-c-(n.left-c)*m,p=t.top-h-(n.top-h)*m;this.wrapper.style.transform=`matrix(${m}, 0, 0, ${m}, ${f}, ${p})`,this.wrapper.style.transformOrigin="top left"}switchSourceImage(e){var t;null!==this.sourceImage&&(this.sourceImage.style.visibility="",this.sourceImage=null),null!==e&&(this.sourceImage=e),this.transImage.src=null!==(t=null==e?void 0:e.getAttribute("src"))&&void 0!==t?t:""}}function q(e){let t=parseFloat(getComputedStyle(e,"::before").width)+parseFloat(getComputedStyle(e,"::after").width);return t==t?t:0}function k(e,t){let n=document.querySelector(`a[href="${e}"]`);if(null===n)return!1;let i=document.querySelector(`[data-slideshow-for="${e}"]`);return null!==i&&(function(e,t,n,i){null===T&&(T=new SlideshowContext),T.begin(e,t,n,i)}(n,i,t,M),!0)}function M(){let e=location.href,t=e.indexOf("#");var n;if(-1!==t)if(history.state&&history.state.isPrevURLBare){let{scrollTop:e,scrollLeft:t}=document.documentElement;history.back(),(n=()=>{document.documentElement.scrollTo({top:e,left:t,behavior:"instant"})})(),requestAnimationFrame(n),setTimeout(n,0)}else history.pushState({isPrevURLBare:!1},"",e.substring(0,t))}window.addEventListener("red.argon.pageLayout",function(){let e=document.querySelector(".main");if(null===e)return;let t=document.querySelector(".sidebar-background");if(null===t)return;let n=document.querySelector(".page-banner-image"),i=document.documentElement,l=e.classList.contains("wide"),o=NaN;for(let s=0;s<4;++s){let s=i.clientWidth;if(s===o)break;let r=t.offsetWidth,a=getComputedStyle(i),u=parseFloat(a.fontSize),d=getComputedStyle(e),c=parseFloat(d.paddingLeft),h=parseFloat(d.paddingRight),m=s-c-h-r;m=Math.min(40,Math.floor(m/u))*u;let p=(s-(m+c+h))/2+Math.min(r/2,c);p=Math.max(r,Math.floor(p)),l&&(m=s-p-c-h-(p-r),m=Math.min(51,Math.floor(m/u))*u),e.style.width=m+"px",e.style.marginLeft=p-r+"px",null!==n&&(n.style.marginLeft=r-p-c+"px",n.style.width=s-r+"px"),null!==f&&w(),v(s,p+c+m,u),o=s}}),e(()=>{k(location.hash,!1);let e=document.querySelector(".main");null!==e&&function(e){let t=e.querySelectorAll("code");for(let e of t)"PRE"!==e.parentElement.tagName&&y(e,e=>{let t=null,n=0,i=0,l=e.data;for(let e=0;e<l.length;++e){let o=l[e],s=0;switch(s=""===o.trim()?0:o>="a"&&o<="z"?1:o>="A"&&o<="Z"?2:o>="0"&&o<="9"?3:"'"===o||'"'===o?4:5,10*i+s){case 12:case 13:case 23:case 51:case 52:case 53:null===t?t=document.createDocumentFragment():t.appendChild(document.createElement("wbr")),t.append(l.slice(n,e)),n=e}i=s}if(null!==t)return t.appendChild(document.createElement("wbr")),t.append(l.slice(n)),t})}(e)}),window.addEventListener("hashchange",()=>{var e;k(location.hash,!0)||(e=!0,null!==T&&T.end(e))}),window.addEventListener("click",e=>{let t=e.target;for(;null!==t&&"A"!==t.tagName;)t=t.parentElement;if(null===t)return;let n=t.getAttribute("href");if(null!==n&&"#"===n[0]&&k(n,!0)){e.preventDefault();let n=location.href.includes("#"),i=t.href;history.pushState({isPrevURLBare:!n},"",i)}})}();
