!function(){"use strict";function e(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function t(e,t){n.add(e)}let n=new WeakSet,i=null,s={passive:!1};function l(e){let t;if("button"in e){if(0!==e.button)return;t=null}else{let n=e.touches;if(1!==n.length)return;t=n[0]}null!==i&&i.element.isConnected?a(null):u();let l=e.target;for(;null!==l;){if(n.has(l)){let n=null===t?d("red.argon.mouseDown",e,null):d("red.argon.mouseDown",e,null,t);if(l.dispatchEvent(n),!n.defaultPrevented){i={element:l,touchIdentifier:null===t?null:t.identifier,lastEvent:n},e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",o,s),window.addEventListener("touchmove",o,s),window.addEventListener("mouseup",r,s),window.addEventListener("touchend",r,s),window.addEventListener("touchcancel",r,s);break}}l=l.parentElement}}function o(e){if(null!==i){if(!i.element.isConnected)return u();if(e.preventDefault(),e.stopPropagation(),"button"in e)if(1&e.buttons){let t=d("red.argon.mouseDragged",e,i.lastEvent);i.element.dispatchEvent(t),i.lastEvent=t}else a(e);else{for(let t of e.touches){if(t.identifier!==i.touchIdentifier)continue;let n=d("red.argon.mouseDragged",e,i.lastEvent,t);return i.element.dispatchEvent(n),void(i.lastEvent=n)}a(null)}}}function r(e){if(null!==i){if(!i.element.isConnected)return u();if(e.preventDefault(),e.stopPropagation(),"button"in e)1&e.buttons||a(e);else{for(let t of e.touches)if(t.identifier===i.touchIdentifier)return;a(null)}}}function a(e){let t=d("red.argon.mouseUp",null===e?i.lastEvent:e,i.lastEvent);i.element.dispatchEvent(t),u()}function u(e){window.removeEventListener("mousemove",o),window.removeEventListener("touchmove",o),window.removeEventListener("mouseup",r),window.removeEventListener("touchend",r),window.removeEventListener("touchcancel",r),i=null}function d(e,t,n,i){let s=void 0===i?t:i,l=new MouseEvent(e,{cancelable:!0,bubbles:!1,view:t.view,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,button:0,buttons:"red.argon.mouseUp"===e?0:1,movementX:null===n?0:s.screenX-n.screenX,movementY:null===n?0:s.screenY-n.screenY,clientX:s.clientX,clientY:s.clientY,screenX:s.screenX,screenY:s.screenY});return l.leafTarget="leafTarget"in t?t.leafTarget:t.target,l}if(window.addEventListener("mousedown",l,s),window.addEventListener("touchstart",l,s),"ResizeObserver"in window){new ResizeObserver(m).observe(document.documentElement)}else window.addEventListener("resize",m),window.addEventListener("orientationchange",m);function c(){requestAnimationFrame(m)}document.addEventListener("load",c,!0),document.addEventListener("error",c,!0),void 0!==document.fonts.addEventListener&&(document.fonts.addEventListener("loading",c),document.fonts.addEventListener("loadingdone",c),document.fonts.addEventListener("loadingerror",c)),"complete"===document.readyState&&m();let h=!1;function m(){h||(h=!0,f(()=>{h=!1;let e=new Event("red.argon.pageLayout");window.dispatchEvent(e)}))}const f="queueMicrotask"in window?queueMicrotask:"Promise"in window?function(e){Promise.resolve().then(e)}:function(e){setTimeout(e,0)};let p=null,g=null;function w(){let e=document.documentElement.scrollHeight,t=document.documentElement.clientHeight,n=document.documentElement.scrollTop/Math.min(t,e-t);if(p.style.opacity=Math.max(0,1-1.1*n).toString(),g)for(let e of g)e.style.opacity=Math.max(0,1-2*n).toString()}function v(){let e=document.querySelector(".hero-title");if(null===e)return;let t=document.documentElement.clientHeight,n=e.getBoundingClientRect().bottom-document.documentElement.getBoundingClientRect().top,i=p.offsetHeight;p.style.marginTop=Math.max(0,t-n-2*i)+"px",w()}function y(e,t,n){let i=document.querySelector(".footnotes");if(null===i)return;let s=e-t-3.5*n,l=t+Math.max(2.5*n,Math.floor(.1*s)),o=.8125*n,r=Math.floor(s/o);r<14?(s=0,i.classList.remove("all-sidenotes")):(r=Math.min(r,22),s=r*o,i.classList.add("all-sidenotes"));let a=0,u=i.querySelectorAll('li[id^="fn"]');for(let e of u){if(0===s){e.classList.remove("sidenote"),e.removeAttribute("style");continue}let t=a,n=e.querySelector("a.footnote-backref");if(null!==n){let e=document.querySelector(n.hash);null!==e&&(t=Math.max(t,e.getBoundingClientRect().top+window.scrollY))}e.classList.add("sidenote"),e.style.top=t+"px",e.style.left=l+"px",e.style.width=s+"px",a=t+e.offsetHeight}}function E(e,t){let n,i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),s=null;for(;(n=i.nextNode())||null!==s;){if(null!==s){let e=t(s);switch(!0){case null===e||""===e:s.remove();break;case"string"==typeof e:s.data=e;break;case e instanceof Node:s.replaceWith(e)}}s=n}}e(()=>{!function(){for(let e of document.querySelectorAll('a[id^="fnref"][href^="#fn"]')){let t=e.getAttribute("href").substring(1),n=document.getElementById(t);null!==n&&n.setAttribute("ref-tag",e.innerText)}}(),p=document.querySelector(".hero-chevron-up"),g=document.querySelectorAll(".nav-list .fly"),null!==p&&(window.addEventListener("scroll",w),v())});let b=new WeakMap;function L(e,n,i,s){let l="h"===i[0],o=b.get(e);if(void 0===o){let t=[null,null],n=function(e,t){let n=null;return()=>{null===n&&(n=requestAnimationFrame(()=>{n=null;for(let n of t){if(null===n)continue;let t=T(e,n);for(let e of n.knobs){if(t[0]===t[1]&&0===t[2]){e.style.visibility="hidden";continue}let i=e.parentElement,s=n.hori?i.clientWidth:i.clientHeight,{translate:l,size:o}=S(t,s);e.style.visibility="",n.hori?(e.style.left=l+"px",e.style.width=o+"px"):(e.style.top=l+"px",e.style.height=o+"px")}}}))}}(e,t);b.set(e,o={axes:t,update:n}),e.addEventListener("scroll",o.update,{passive:!0}),e.addEventListener("wheel",o.update,{passive:!0}),e.addEventListener("touchmove",o.update,{passive:!0})}let r=o.axes[l?0:1];null===r&&(o.axes[l?0:1]=r={hori:l,knobs:new Set,inset:void 0===s?null:s}),r.knobs.add(n);let a=n.parentElement;t(a);let u=function(e,t,n){let i=0,s=0,l=0;return o=>{switch(o.type){case"red.argon.mouseDown":let r=e.getBoundingClientRect(),a=n.hori?r.x:r.y,u=T(t,n);l=u[0]-u[1];let d=n.hori?e.clientWidth:e.clientHeight,{translate:c,size:h}=S(u,d);i=a+h/2,s=a+d-h/2;let m=a+c+h/2-(n.hori?o.clientX:o.clientY);if(Math.abs(m)<h/2){i-=m,s-=m;break}case"red.argon.mouseDragged":case"red.argon.mouseUp":let f=((n.hori?o.clientX:o.clientY)-i)/(s-i)*l;n.hori?t.scrollLeft=f:t.scrollTop=f}}}(a,e,r);return a.addEventListener("red.argon.mouseDown",u),a.addEventListener("red.argon.mouseDragged",u),a.addEventListener("red.argon.mouseUp",u),o.update(),o.update}function T(e,t){let n=t.hori?e.scrollWidth:e.scrollHeight,i=t.hori?e.clientWidth:e.clientHeight,s=t.hori?e.scrollLeft:e.scrollTop;if(null!==t.inset){let s=t.inset(e);n-=s,i-=s}return[n,i,s]}function S(e,t){let n,i,[s,l,o]=e;o>=s-l?(n=l/(o+l),i=1):o<=0?(n=l/(s-o),i=0):(n=l/s,i=o/(s-l));let r=Math.min(t,Math.max(20,t*n));return{translate:i*(t-r),size:r}}let x=null;class SlideshowContext{constructor(){this.root=document.createElement("aside"),this.root.className="slideshow",this.root.innerHTML='<div class="slideshow-wrapper"><div class="slideshow-content"><header class="slideshow-header"><button class="slideshow-exit"></button><h1 class="slideshow-title"></h1><div class="slideshow-meta"></div></header><main class="slideshow-body"></main><aside class="slideshow-scroller"><button class="slideshow-scroller-knob"></button></aside></div><img class="slideshow-transimage"></div>',this.wrapper=this.root.querySelector(".slideshow-wrapper"),this.title=this.root.querySelector(".slideshow-title"),this.meta=this.root.querySelector(".slideshow-meta"),this.body=this.root.querySelector(".slideshow-body"),this.transImage=this.root.querySelector(".slideshow-transimage"),this.updateScroller=L(this.body,this.root.querySelector(".slideshow-scroller-knob"),"horizontal",I),this.visibility=0,this.sourceImage=null,this.requestedFrame=null,this.transitionTimer=null,this.endingAction=null;let e=!1,n=-1/0;this.body.addEventListener("wheel",t=>{t.timeStamp-n>80&&(e=Math.abs(t.deltaY)>Math.abs(t.deltaX)),e&&(this.body.scrollLeft+=t.deltaY,t.preventDefault()),n=t.timeStamp});let i=null;t(this.wrapper),this.wrapper.addEventListener("red.argon.mouseDown",e=>{i=null;let t=!0,n=!0,s=e.leafTarget;for(;null!==s&&s!==this.root;){let e=s.classList;if(e.contains("slideshow-exit"))break;if(e.contains("slideshow-title")){n=!1;break}if(e.contains("slideshow-meta")){n=!1;break}if(e.contains("work-slide-image")){n=!1;break}if(e.contains("slideshow-scroller")){n=!1;break}if(!t&&e.contains("work-slide-title")){n=!1;break}s=s.parentElement,t=!1}n?i=[e.screenX,e.screenY]:e.preventDefault()}),this.wrapper.addEventListener("red.argon.mouseUp",e=>{if(null===i)return;let[t,n]=[e.screenX,e.screenY];Math.hypot(t-i[0],n-i[1])<4&&(null!==this.endingAction&&this.endingAction(),this.end(!0))}),this.wrapper.addEventListener("keydown",e=>{"Escape"===e.key&&(e.stopPropagation(),null!==this.endingAction&&this.endingAction(),this.end(!0))}),window.addEventListener("red.argon.pageLayout",this.updateScroller)}begin(e,t,n,i){this.endingAction=i;let s=e.querySelector(".work-entry-image"),l=e.querySelector(".work-entry-title"),o=e.querySelector(".work-entry-meta");switch(this.switchSourceImage(s),this.title.innerHTML=null===l?"":l.innerHTML,this.meta.innerHTML=null===o?"":o.innerHTML,this.body.innerHTML=t.innerHTML,this.visibility){case 0:document.body.appendChild(this.root);case 3:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!n){null!==s&&(s.style.visibility="hidden"),this.visibility=2;break}this.visibility=1,this.root.classList.add("out"),this.requestedFrame=requestAnimationFrame(()=>{this.requestedFrame=null,null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.transitionTimer=setTimeout(()=>{this.root.classList.add("animating"),this.root.classList.remove("out"),this.transformWrapperTo(null),null!==this.sourceImage&&(this.sourceImage.style.visibility="hidden"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.visibility=2},490)},50)});break;case 1:case 2:null!==this.sourceImage&&(this.sourceImage.style.visibility="hidden")}this.updateScroller()}end(e){switch(this.endingAction=null,this.visibility){case 0:case 3:break;case 2:case 1:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!e)return this.switchSourceImage(null),this.visibility=0,void this.root.remove();this.visibility=3,this.root.classList.add("animating"),null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.root.classList.add("out"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.root.classList.remove("out"),this.visibility=0,this.root.remove(),this.transformWrapperTo(null),this.switchSourceImage(null)},450)}}transformWrapperTo(e){if(null===e)return void(this.wrapper.style.transform="");let t=e.getBoundingClientRect(),n=this.transImage.getBoundingClientRect(),i=getComputedStyle(this.wrapper).transform.match(/^matrix\((.+),(.+),(.+),(.+),(.+),(.+)\)$/),[s,l,o,r,a,u]=null===i?[1,0,0,1,0,0]:i.slice(1).map(parseFloat);n={top:n.top/r-u/r,left:n.left/s-a/s,width:n.width/s,height:n.height/r};let d=this.root.getBoundingClientRect(),c=d.left,h=d.top,m=t.width/n.width,f=t.left-c-(n.left-c)*m,p=t.top-h-(n.top-h)*m;this.wrapper.style.transform=`matrix(${m}, 0, 0, ${m}, ${f}, ${p})`,this.wrapper.style.transformOrigin="top left"}switchSourceImage(e){var t;null!==this.sourceImage&&(this.sourceImage.style.visibility="",this.sourceImage=null),null!==e&&(this.sourceImage=e),this.transImage.src=null!==(t=null==e?void 0:e.getAttribute("src"))&&void 0!==t?t:""}}function I(e){let t=parseFloat(getComputedStyle(e,"::before").width)+parseFloat(getComputedStyle(e,"::after").width);return t==t?t:0}const A=/[（［｛〔〈《｟【〖「『]+/,k=/[）］｝〕〉》｠〗】」』]+/,M=new RegExp(`${k.source}|[．，、。：；！？]`),q=new RegExp(`${k.source}|[．，、。]`),D="……+|——+|·| ?“|” ?| ?‘|’ ?",H=new RegExp(`${A.source}|${k.source}`,"g"),C=new RegExp(`${A.source}|${k.source}|${D}`,"g"),R=new RegExp(`${A.source}|${M.source}|${D}`,"g"),F=new RegExp(`${A.source}|${q.source}|${D}`,"g");let N;try{N=/(\p{sc=Hani}|\p{sc=Hira}|\p{sc=Kana}|\p{sc=Bopo})+/uy}catch(e){N=/[ぁ-ヿㄅ-ㄯ㐀-䶿一-鿿豈-舘]+/y}const O=new Set(["BASE","HEAD","LINK","META","TITLE","STYLE","SCRIPT","INPUT","TEXTAREA","IMG","VIDEO","CANVAS","CODE","PRE","MATH","SVG","EMBED"]),$=new Set(["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","BODY","DD","DIV","DL","DT","FIELDSET","FIGURE","FIGCAPTION","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HR","LI","MAIN","NAV","OL","P","SECTION","TABLE","TBODY","TD","TH","TR","THEAD","TFOOT","UL","BR"]);function B(e){e.type=0,e.span=null}function z(e,t,n){void 0===t&&(t={type:0,span:null}),O.has(e.tagName)||e.classList.contains("cjk-punc")?B(t):($.has(e.tagName)&&B(t),(void 0===n||e.hasAttribute("lang"))&&(n=e.matches(":lang(ja)")?3:e.matches(":lang(zh-Hans), :lang(zh-CN)")?2:e.matches(":lang(zh-Hant), :lang(zh-TW), :lang(zh-HK), :lang(zh-MO)")?1:0),function(e,t,n){for(let i=0;i<e.childNodes.length;++i){let s=e.childNodes[i];switch(s.nodeType){case Node.ELEMENT_NODE:z(s,t,n);break;case Node.TEXT_NODE:let l=W(s.data,t,n);null!==l&&(i+=l.childNodes.length-1,e.replaceChild(l,s))}}}(e,t,n))}function W(e,t,n){if(0===e.length)return null;const i=A,s=M;let l;switch(n){case 0:l=H;break;case 1:l=C;break;case 2:l=R;break;case 3:l=F}let o=0;l.lastIndex=0;let r=null,a=null,u=!1;for(;null!==(r=l.exec(e));){null===a&&(a=document.createDocumentFragment());let n=r[0],d=l.lastIndex-n.length;if("·"===n){let t=e[d-1],n=e[d+1];if(N.lastIndex=0,void 0!==t&&!N.test(t)||void 0!==n&&!N.test(n)){l.lastIndex+=1;continue}}let c=n[0],h="”"===c||"’"===c;if(!u&&h){l.lastIndex+=1;continue}let m=n[n.length-1],f="“"===m||"‘"===m;if(f){let t="“"===m?"”":"’";if(N.lastIndex=l.lastIndex,!N.test(e)||e[N.lastIndex]!==t){l.lastIndex+=1;continue}u=!0}o!==d&&(a.append(e.substring(o,d)),-1===t.type&&" "===e[o]&&t.span.classList.remove("space-after"),B(t));let p=f||i.test(n)?1:h||s.test(n)?-1:0;o=l.lastIndex;let g=document.createElement("span");switch(g.textContent=n,g.classList.add("cjk-punc"),p){case 1:g.classList.add("hwid")," "!==c&&g.classList.add("space-before"),1===t.type&&g.classList.remove("space-before");break;case-1:g.classList.add("hwid")," "!==m&&g.classList.add("space-after"),-1===t.type&&t.span.classList.remove("space-after")}u=f,a.append(g),t.type=p,t.span=g}return null!==a&&o!==e.length&&(a.append(e.substring(o)),-1===t.type&&" "===e[o]&&t.span.classList.remove("space-after"),B(t)),a}const Y=/^[!-~–—“”‘’\s]+$/;function P(e,t){let n=document.querySelector(`a[href="${e}"]`);if(null===n)return!1;let i=document.querySelector(`[data-slideshow-for="${e}"]`);return null!==i&&(function(e,t,n,i){null===x&&(x=new SlideshowContext),x.begin(e,t,n,i)}(n,i,t,X),!0)}function X(){let e=location.href,t=e.indexOf("#");var n;if(-1!==t)if(history.state&&history.state.isPrevURLBare){let{scrollTop:e,scrollLeft:t}=document.documentElement;history.back(),(n=()=>{document.documentElement.scrollTo({top:e,left:t,behavior:"instant"})})(),requestAnimationFrame(n),setTimeout(n,0)}else history.pushState({isPrevURLBare:!1},"",e.substring(0,t))}window.addEventListener("red.argon.pageLayout",function(){let e=document.querySelector(".main");if(null===e)return;let t=document.querySelector(".sidebar-background");if(null===t)return;let n=document.querySelector(".page-banner-image"),i=document.documentElement,s=e.classList.contains("wide"),l=NaN;for(let o=0;o<4;++o){let o=i.clientWidth;if(o===l)break;let r=t.offsetWidth,a=getComputedStyle(i),u=parseFloat(a.fontSize),d=getComputedStyle(e),c=parseFloat(d.paddingLeft),h=parseFloat(d.paddingRight),m=o-c-h-r;m=Math.min(40,Math.floor(m/u))*u;let f=(o-(m+c+h))/2+Math.min(r/2,c);f=Math.max(r,Math.floor(f)),s&&(m=o-f-c-h-(f-r),m=Math.min(51,Math.floor(m/u))*u),e.style.width=m+"px",e.style.marginLeft=f-r+"px",null!==n&&(n.style.marginLeft=r-f-c+"px",n.style.width=o-r+"px"),null!==p&&v(),y(o,f+c+m,u),l=o}}),e(()=>{z(document.body),function(e){for(let t of e.querySelectorAll("a:lang(zh), a:lang(ja), u:lang(zh), u:lang(ja)"))!t.hasAttribute("lang")&&Y.test(t.textContent)&&t.classList.add("latin-underline")}(document.body),P(location.hash,!1);let e=document.querySelector(".main");null!==e&&function(e){for(let t of e.querySelectorAll("code"))"PRE"!==t.parentElement.tagName&&E(t,e=>{let t=null,n=0,i=0,s=e.data;for(let e=0;e<s.length;++e){let l=s[e],o=0;switch(o=""===l.trim()?0:l>="a"&&l<="z"?1:l>="A"&&l<="Z"?2:l>="0"&&l<="9"?3:"-"===l||"_"===l?4:5,10*i+o){case 12:case 13:case 23:case 41:case 42:case 43:let i=s.substring(n,e);if(i.trim().length<3)break;null===t?t=document.createDocumentFragment():t.appendChild(document.createElement("wbr")),t.append(i),n=e}i=o}if(null!==t)return t.appendChild(document.createElement("wbr")),t.append(s.substring(n)),t})}(e)}),window.addEventListener("hashchange",()=>{var e;P(location.hash,!0)||(e=!0,null!==x&&x.end(e))}),window.addEventListener("click",e=>{let t=e.target;for(;null!==t&&"A"!==t.tagName;)t=t.parentElement;if(null===t)return;let n=t.getAttribute("href");if(null!==n&&"#"===n[0]&&P(n,!0)){e.preventDefault();let n=location.href.includes("#"),i=t.href;history.pushState({isPrevURLBare:!n},"",i)}})}();
