!function(){"use strict";function e(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function t(e,t){i.add(e)}let i=new WeakSet,n=null;function s(e){if(null!==n){if(!n.isConnected)return r();if(e.preventDefault(),e.stopPropagation(),1&e.buttons){let t=a(e,"red.argon.mouseDragged");n.dispatchEvent(t)}else l(e)}}function o(e){if(null!==n){if(!n.isConnected)return r();e.preventDefault(),e.stopPropagation(),1&e.buttons||l(e)}}function l(e){let t=a(e,"red.argon.mouseUp");n.dispatchEvent(t),r()}function r(e){window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",o),n=null}function a(e,t){let i=new MouseEvent(t,{cancelable:!0,bubbles:!1,view:e.view,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,button:0,buttons:e.buttons,clientX:e.clientX,clientY:e.clientY,movementX:e.movementX,movementY:e.movementY,screenX:e.screenX,screenY:e.screenY});return i.leafTarget=e.target,i}if(window.addEventListener("mousedown",e=>{if(0===e.button)for(null!==n&&n.isConnected&&l(e),n=e.target;null!==n;){if(i.has(n)){let t=a(e,"red.argon.mouseDown");if(n.dispatchEvent(t),!t.defaultPrevented){e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",s),window.addEventListener("mouseup",o);break}}n=n.parentElement}}),"ResizeObserver"in window){new ResizeObserver(d).observe(document.documentElement)}else window.addEventListener("resize",d),window.addEventListener("orientationchange",d);document.addEventListener("load",()=>{requestAnimationFrame(d)},!0),"complete"===document.readyState&&d();let u=!1;function d(){u||(u=!0,c(()=>{u=!1;let e=new Event("red.argon.pageLayout");window.dispatchEvent(e)}))}const c="queueMicrotask"in window?queueMicrotask:"Promise"in window?function(e){Promise.resolve().then(e)}:function(e){setTimeout(e,0)};let h=null,m=null;function p(){let e=document.documentElement.scrollHeight,t=document.documentElement.clientHeight,i=document.documentElement.scrollTop/Math.min(t,e-t);if(h.style.opacity=Math.max(0,1-1.1*i).toString(),m)for(let e of m)e.style.opacity=Math.max(0,1-2*i).toString()}function f(){let e=document.querySelector(".hero-title");if(null===e)return;let t=document.documentElement.clientHeight,i=e.getBoundingClientRect().bottom-document.documentElement.getBoundingClientRect().top,n=h.offsetHeight;h.style.marginTop=Math.max(0,t-i-2*n)+"px",p()}function g(e,t,i){let n=document.querySelector(".footnotes");if(null===n)return;let s=e-t-3.5*i,o=t+Math.max(2.5*i,Math.floor(.1*s)),l=.8125*i,r=Math.floor(s/l);r<14?(s=0,n.classList.remove("all-sidenotes")):(r=Math.min(r,22),s=r*l,n.classList.add("all-sidenotes"));let a=0,u=n.querySelectorAll('li[id^="fn"]');for(let e of u){if(0===s){e.classList.remove("sidenote"),e.removeAttribute("style");continue}let t=a,i=e.querySelector("a.footnote-backref");if(null!==i){let e=document.querySelector(i.hash);null!==e&&(t=Math.max(t,e.getBoundingClientRect().top+window.scrollY))}e.classList.add("sidenote"),e.style.top=t+"px",e.style.left=o+"px",e.style.width=s+"px",a=t+e.offsetHeight}}function w(e,t){let i,n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),s=null;for(;(i=n.nextNode())||null!==s;){if(null!==s){let e=t(s);switch(!0){case null===e||""===e:s.remove();break;case"string"==typeof e:s.data=e;break;case e instanceof Node:s.replaceWith(e)}}s=i}}e(()=>{h=document.querySelector(".hero-chevron-up"),m=document.querySelectorAll(".nav-list .fly"),null!==h&&(window.addEventListener("scroll",p),f())});let y=new WeakMap;function v(e,i,n,s){let o="h"===n[0],l=y.get(e);if(void 0===l){let t=[null,null],i=function(e,t){let i=null;return()=>{null===i&&(i=requestAnimationFrame(()=>{i=null;for(let i of t){if(null===i)continue;let t=b(e,i);for(let e of i.knobs){if(t[0]===t[1]&&0===t[2]){e.style.visibility="hidden";continue}let n=e.parentElement,s=i.hori?n.clientWidth:n.clientHeight,{translate:o,size:l}=L(t,s);e.style.visibility="",i.hori?(e.style.left=o+"px",e.style.width=l+"px"):(e.style.top=o+"px",e.style.height=l+"px")}}}))}}(e,t);y.set(e,l={axes:t,update:i}),e.addEventListener("scroll",l.update,{passive:!0}),e.addEventListener("wheel",l.update,{passive:!0}),e.addEventListener("touchmove",l.update,{passive:!0})}let r=l.axes[o?0:1];null===r&&(l.axes[o?0:1]=r={hori:o,knobs:new Set,inset:void 0===s?null:s}),r.knobs.add(i);let a=i.parentElement;t(a);let u=function(e,t,i){let n=0,s=0,o=0;return l=>{switch(l.type){case"red.argon.mouseDown":let r=e.getBoundingClientRect(),a=i.hori?r.x:r.y,u=b(t,i);o=u[0]-u[1];let d=i.hori?e.clientWidth:e.clientHeight,{translate:c,size:h}=L(u,d);n=a+h/2,s=a+d-h/2;let m=a+c+h/2-(i.hori?l.clientX:l.clientY);if(Math.abs(m)<h/2){n-=m,s-=m;break}case"red.argon.mouseDragged":case"red.argon.mouseUp":let p=((i.hori?l.clientX:l.clientY)-n)/(s-n)*o;i.hori?t.scrollLeft=p:t.scrollTop=p}}}(a,e,r);return a.addEventListener("red.argon.mouseDown",u),a.addEventListener("red.argon.mouseDragged",u),a.addEventListener("red.argon.mouseUp",u),l.update(),l.update}function b(e,t){let i=t.hori?e.scrollWidth:e.scrollHeight,n=t.hori?e.clientWidth:e.clientHeight,s=t.hori?e.scrollLeft:e.scrollTop;if(null!==t.inset){let s=t.inset(e);i-=s,n-=s}return[i,n,s]}function L(e,t){let i,n,[s,o,l]=e;l>=s-o?(i=o/(l+o),n=1):l<=0?(i=o/(s-l),n=0):(i=o/s,n=l/(s-o));let r=Math.min(t,Math.max(20,t*i));return{translate:n*(t-r),size:r}}let S=null;class SlideshowContext{constructor(){this.root=document.createElement("aside"),this.root.className="slideshow",this.root.innerHTML='<div class="slideshow-wrapper"><div class="slideshow-content"><header class="slideshow-header"><button class="slideshow-exit"></button><h1 class="slideshow-title"></h1><div class="slideshow-meta"></div></header><main class="slideshow-body"></main><aside class="slideshow-scroller"><button class="slideshow-scroller-knob"></button></aside></div><img class="slideshow-transimage"></div>',this.wrapper=this.root.querySelector(".slideshow-wrapper"),this.title=this.root.querySelector(".slideshow-title"),this.meta=this.root.querySelector(".slideshow-meta"),this.body=this.root.querySelector(".slideshow-body"),this.transImage=this.root.querySelector(".slideshow-transimage"),this.updateScroller=v(this.body,this.root.querySelector(".slideshow-scroller-knob"),"horizontal",E),this.visibility=0,this.sourceImage=null,this.requestedFrame=null,this.transitionTimer=null,this.endingAction=null;let e=!1,i=-1/0;this.body.addEventListener("wheel",t=>{t.timeStamp-i>80&&(e=Math.abs(t.deltaY)>Math.abs(t.deltaX)),e&&(this.body.scrollLeft+=t.deltaY,t.preventDefault()),i=t.timeStamp});let n=null;t(this.wrapper),this.wrapper.addEventListener("red.argon.mouseDown",e=>{n=null;let t=!0,i=e.leafTarget;for(;null!==i&&i!==this.root;){let e=i.classList;if(e.contains("slideshow-exit"))break;if(e.contains("slideshow-header"))return;if(e.contains("slideshow-scroller"))return;if(!t&&e.contains("slideshow-body"))return;i=i.parentElement,t=!1}n=e.leafTarget}),this.wrapper.addEventListener("red.argon.mouseUp",e=>{e.leafTarget===n&&(null!==this.endingAction&&this.endingAction(),this.end(!0))}),this.wrapper.addEventListener("keydown",e=>{"Escape"===e.key&&(e.stopPropagation(),null!==this.endingAction&&this.endingAction(),this.end(!0))}),window.addEventListener("red.argon.pageLayout",this.updateScroller)}begin(e,t,i,n){this.endingAction=n;let s=e.querySelector(".work-entry-image"),o=e.querySelector(".work-entry-title"),l=e.querySelector(".work-entry-meta");switch(this.switchSourceImage(s),this.title.innerHTML=null===o?"":o.innerHTML,this.meta.innerHTML=null===l?"":l.innerHTML,this.body.innerHTML=t.innerHTML,this.visibility){case 0:document.body.appendChild(this.root);case 3:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!i){null!==s&&(s.style.visibility="hidden"),this.visibility=2;break}this.visibility=1,this.root.classList.add("out"),this.requestedFrame=requestAnimationFrame(()=>{null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.requestedFrame=requestAnimationFrame(()=>{this.requestedFrame=null,this.root.classList.add("animating"),this.root.classList.remove("out"),this.transformWrapperTo(null),null!==this.sourceImage&&(this.sourceImage.style.visibility="hidden"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.visibility=2},550)})})}this.updateScroller()}end(e){switch(this.endingAction=null,this.visibility){case 0:case 3:break;case 2:case 1:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!e)return this.switchSourceImage(null),this.visibility=0,void this.root.remove();this.visibility=3,this.root.classList.add("animating"),null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.root.classList.add("out"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.root.classList.remove("out"),this.visibility=0,this.root.remove(),this.transformWrapperTo(null),this.switchSourceImage(null)},450)}}transformWrapperTo(e){if(null===e)return void(this.wrapper.style.transform="");let t=e.getBoundingClientRect(),i=this.transImage.getBoundingClientRect(),n=getComputedStyle(this.wrapper).transform.match(/^matrix\((.+),(.+),(.+),(.+),(.+),(.+)\)$/),[s,o,l,r,a,u]=null===n?[1,0,0,1,0,0]:n.slice(1).map(parseFloat);i={top:i.top/r-u/r,left:i.left/s-a/s,width:i.width/s,height:i.height/r};let d=this.root.getBoundingClientRect(),c=d.left,h=d.top,m=t.width/i.width,p=t.left-c-(i.left-c)*m,f=t.top-h-(i.top-h)*m;this.wrapper.style.transform=`matrix(${m}, 0, 0, ${m}, ${p}, ${f})`,this.wrapper.style.transformOrigin="top left"}switchSourceImage(e){var t;null!==this.sourceImage&&(this.sourceImage.style.visibility="",this.sourceImage=null),null!==e&&(this.sourceImage=e),this.transImage.src=null!==(t=null==e?void 0:e.getAttribute("src"))&&void 0!==t?t:""}}function E(e){let t=parseFloat(getComputedStyle(e,"::before").width)+parseFloat(getComputedStyle(e,"::after").width);return t==t?t:0}function q(e){let t=document.querySelector(`a[href="${location.hash}"]`);if(null===t)return!1;let i=document.querySelector(`[data-slideshow-for="${location.hash}"]`);return null!==i&&(function(e,t,i,n){null===S&&(S=new SlideshowContext),S.begin(e,t,i,n)}(t,i,e,M),!0)}e(()=>{q(!1);let e=document.querySelector(".main");null!==e&&function(e){let t=e.querySelectorAll("code");for(let e of t)"PRE"!==e.parentElement.tagName&&w(e,e=>{let t=null,i=0,n=0,s=e.data;for(let e=0;e<s.length;++e){let o=s[e],l=0;switch(l=""===o.trim()?0:o>="a"&&o<="z"?1:o>="A"&&o<="Z"?2:o>="0"&&o<="9"?3:"'"===o||'"'===o?4:5,10*n+l){case 12:case 13:case 23:case 51:case 52:case 53:null===t?t=document.createDocumentFragment():t.appendChild(document.createElement("wbr")),t.append(s.slice(i,e)),i=e}n=l}if(null!==t)return t.appendChild(document.createElement("wbr")),t.append(s.slice(i)),t})}(e)}),window.addEventListener("red.argon.pageLayout",function(){let e=document.querySelector(".main");if(null===e)return;let t=document.querySelector(".sidebar-background");if(null===t)return;let i=document.querySelector(".page-banner-image"),n=document.documentElement,s=e.classList.contains("wide"),o=NaN;for(let l=0;l<4;++l){let l=n.clientWidth;if(l===o)break;let r=t.offsetWidth,a=getComputedStyle(n),u=parseFloat(a.fontSize),d=getComputedStyle(e),c=parseFloat(d.paddingLeft),m=parseFloat(d.paddingRight),p=l-c-m-r;p=Math.min(40,Math.floor(p/u))*u;let w=(l-(p+c+m))/2+Math.min(r/2,c);w=Math.max(r,Math.floor(w)),s&&(p=l-w-c-m-(w-r),p=Math.min(51,Math.floor(p/u))*u),e.style.width=p+"px",e.style.marginLeft=w-r+"px",null!==i&&(i.style.marginLeft=r-w-c+"px",i.style.width=l-r+"px"),null!==h&&f(),g(l,w+c+p,u),o=l}});let T=!1;function M(){let e=location.href,t=e.indexOf("#");-1!==t&&(T?history.pushState(history.state,"",e.substring(0,t)):history.back(),T=!1)}window.addEventListener("hashchange",e=>{var t;q(!0)?T=e.oldURL.includes("#"):(t=!0,null!==S&&S.end(t))})}();
