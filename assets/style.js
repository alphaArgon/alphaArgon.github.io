!function(){"use strict";function e(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function t(e,t){n.add(e)}let n=new WeakSet,i=null,l={passive:!1};function s(e){let t;if("button"in e){if(0!==e.button)return;t=null}else{let n=e.touches;if(1!==n.length)return;t=n[0]}null!==i&&i.element.isConnected?a(null):u();let s=e.target;for(;null!==s;){if(n.has(s)){let n=null===t?d("red.argon.mouseDown",e,null):d("red.argon.mouseDown",e,null,t);if(s.dispatchEvent(n),!n.defaultPrevented){i={element:s,touchIdentifier:null===t?null:t.identifier,lastEvent:n},e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",o,l),window.addEventListener("touchmove",o,l),window.addEventListener("mouseup",r,l),window.addEventListener("touchend",r,l),window.addEventListener("touchcancel",r,l);break}}s=s.parentElement}}function o(e){if(null!==i){if(!i.element.isConnected)return u();if(e.preventDefault(),e.stopPropagation(),"button"in e)if(1&e.buttons){let t=d("red.argon.mouseDragged",e,i.lastEvent);i.element.dispatchEvent(t),i.lastEvent=t}else a(e);else{for(let t of e.touches){if(t.identifier!==i.touchIdentifier)continue;let n=d("red.argon.mouseDragged",e,i.lastEvent,t);return i.element.dispatchEvent(n),void(i.lastEvent=n)}a(null)}}}function r(e){if(null!==i){if(!i.element.isConnected)return u();if(e.preventDefault(),e.stopPropagation(),"button"in e)1&e.buttons||a(e);else{for(let t of e.touches)if(t.identifier===i.touchIdentifier)return;a(null)}}}function a(e){let t=d("red.argon.mouseUp",null===e?i.lastEvent:e,i.lastEvent);i.element.dispatchEvent(t),u()}function u(e){window.removeEventListener("mousemove",o),window.removeEventListener("touchmove",o),window.removeEventListener("mouseup",r),window.removeEventListener("touchend",r),window.removeEventListener("touchcancel",r),i=null}function d(e,t,n,i){let l=void 0===i?t:i,s=new MouseEvent(e,{cancelable:!0,bubbles:!1,view:t.view,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,button:0,buttons:"red.argon.mouseUp"===e?0:1,movementX:null===n?0:l.screenX-n.screenX,movementY:null===n?0:l.screenY-n.screenY,clientX:l.clientX,clientY:l.clientY,screenX:l.screenX,screenY:l.screenY});return s.leafTarget="leafTarget"in t?t.leafTarget:t.target,s}if(window.addEventListener("mousedown",s,l),window.addEventListener("touchstart",s,l),"ResizeObserver"in window){new ResizeObserver(h).observe(document.documentElement)}else window.addEventListener("resize",h),window.addEventListener("orientationchange",h);document.addEventListener("load",()=>{requestAnimationFrame(h)},!0),"complete"===document.readyState&&h();let c=!1;function h(){c||(c=!0,m(()=>{c=!1;let e=new Event("red.argon.pageLayout");window.dispatchEvent(e)}))}const m="queueMicrotask"in window?queueMicrotask:"Promise"in window?function(e){Promise.resolve().then(e)}:function(e){setTimeout(e,0)};let f=null,p=null;function g(){let e=document.documentElement.scrollHeight,t=document.documentElement.clientHeight,n=document.documentElement.scrollTop/Math.min(t,e-t);if(f.style.opacity=Math.max(0,1-1.1*n).toString(),p)for(let e of p)e.style.opacity=Math.max(0,1-2*n).toString()}function w(){let e=document.querySelector(".hero-title");if(null===e)return;let t=document.documentElement.clientHeight,n=e.getBoundingClientRect().bottom-document.documentElement.getBoundingClientRect().top,i=f.offsetHeight;f.style.marginTop=Math.max(0,t-n-2*i)+"px",g()}function v(e,t,n){let i=document.querySelector(".footnotes");if(null===i)return;let l=e-t-3.5*n,s=t+Math.max(2.5*n,Math.floor(.1*l)),o=.8125*n,r=Math.floor(l/o);r<14?(l=0,i.classList.remove("all-sidenotes")):(r=Math.min(r,22),l=r*o,i.classList.add("all-sidenotes"));let a=0,u=i.querySelectorAll('li[id^="fn"]');for(let e of u){if(0===l){e.classList.remove("sidenote"),e.removeAttribute("style");continue}let t=a,n=e.querySelector("a.footnote-backref");if(null!==n){let e=document.querySelector(n.hash);null!==e&&(t=Math.max(t,e.getBoundingClientRect().top+window.scrollY))}e.classList.add("sidenote"),e.style.top=t+"px",e.style.left=s+"px",e.style.width=l+"px",a=t+e.offsetHeight}}function y(e,t){let n,i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),l=null;for(;(n=i.nextNode())||null!==l;){if(null!==l){let e=t(l);switch(!0){case null===e||""===e:l.remove();break;case"string"==typeof e:l.data=e;break;case e instanceof Node:l.replaceWith(e)}}l=n}}e(()=>{!function(){for(let e of document.querySelectorAll('a[id^="fnref"][href^="#fn"]')){let t=e.getAttribute("href").substring(1),n=document.getElementById(t);null!==n&&n.setAttribute("ref-tag",e.innerText)}}(),f=document.querySelector(".hero-chevron-up"),p=document.querySelectorAll(".nav-list .fly"),null!==f&&(window.addEventListener("scroll",g),w())});let E=new WeakMap;function b(e,n,i,l){let s="h"===i[0],o=E.get(e);if(void 0===o){let t=[null,null],n=function(e,t){let n=null;return()=>{null===n&&(n=requestAnimationFrame(()=>{n=null;for(let n of t){if(null===n)continue;let t=L(e,n);for(let e of n.knobs){if(t[0]===t[1]&&0===t[2]){e.style.visibility="hidden";continue}let i=e.parentElement,l=n.hori?i.clientWidth:i.clientHeight,{translate:s,size:o}=T(t,l);e.style.visibility="",n.hori?(e.style.left=s+"px",e.style.width=o+"px"):(e.style.top=s+"px",e.style.height=o+"px")}}}))}}(e,t);E.set(e,o={axes:t,update:n}),e.addEventListener("scroll",o.update,{passive:!0}),e.addEventListener("wheel",o.update,{passive:!0}),e.addEventListener("touchmove",o.update,{passive:!0})}let r=o.axes[s?0:1];null===r&&(o.axes[s?0:1]=r={hori:s,knobs:new Set,inset:void 0===l?null:l}),r.knobs.add(n);let a=n.parentElement;t(a);let u=function(e,t,n){let i=0,l=0,s=0;return o=>{switch(o.type){case"red.argon.mouseDown":let r=e.getBoundingClientRect(),a=n.hori?r.x:r.y,u=L(t,n);s=u[0]-u[1];let d=n.hori?e.clientWidth:e.clientHeight,{translate:c,size:h}=T(u,d);i=a+h/2,l=a+d-h/2;let m=a+c+h/2-(n.hori?o.clientX:o.clientY);if(Math.abs(m)<h/2){i-=m,l-=m;break}case"red.argon.mouseDragged":case"red.argon.mouseUp":let f=((n.hori?o.clientX:o.clientY)-i)/(l-i)*s;n.hori?t.scrollLeft=f:t.scrollTop=f}}}(a,e,r);return a.addEventListener("red.argon.mouseDown",u),a.addEventListener("red.argon.mouseDragged",u),a.addEventListener("red.argon.mouseUp",u),o.update(),o.update}function L(e,t){let n=t.hori?e.scrollWidth:e.scrollHeight,i=t.hori?e.clientWidth:e.clientHeight,l=t.hori?e.scrollLeft:e.scrollTop;if(null!==t.inset){let l=t.inset(e);n-=l,i-=l}return[n,i,l]}function T(e,t){let n,i,[l,s,o]=e;o>=l-s?(n=s/(o+s),i=1):o<=0?(n=s/(l-o),i=0):(n=s/l,i=o/(l-s));let r=Math.min(t,Math.max(20,t*n));return{translate:i*(t-r),size:r}}let S=null;class SlideshowContext{constructor(){this.root=document.createElement("aside"),this.root.className="slideshow",this.root.innerHTML='<div class="slideshow-wrapper"><div class="slideshow-content"><header class="slideshow-header"><button class="slideshow-exit"></button><h1 class="slideshow-title"></h1><div class="slideshow-meta"></div></header><main class="slideshow-body"></main><aside class="slideshow-scroller"><button class="slideshow-scroller-knob"></button></aside></div><img class="slideshow-transimage"></div>',this.wrapper=this.root.querySelector(".slideshow-wrapper"),this.title=this.root.querySelector(".slideshow-title"),this.meta=this.root.querySelector(".slideshow-meta"),this.body=this.root.querySelector(".slideshow-body"),this.transImage=this.root.querySelector(".slideshow-transimage"),this.updateScroller=b(this.body,this.root.querySelector(".slideshow-scroller-knob"),"horizontal",I),this.visibility=0,this.sourceImage=null,this.requestedFrame=null,this.transitionTimer=null,this.endingAction=null;let e=!1,n=-1/0;this.body.addEventListener("wheel",t=>{t.timeStamp-n>80&&(e=Math.abs(t.deltaY)>Math.abs(t.deltaX)),e&&(this.body.scrollLeft+=t.deltaY,t.preventDefault()),n=t.timeStamp});let i=null;t(this.wrapper),this.wrapper.addEventListener("red.argon.mouseDown",e=>{i=null;let t=!0,n=!0,l=e.leafTarget;for(;null!==l&&l!==this.root;){let e=l.classList;if(e.contains("slideshow-exit"))break;if(e.contains("slideshow-title")){n=!1;break}if(e.contains("slideshow-meta")){n=!1;break}if(e.contains("work-slide-image")){n=!1;break}if(e.contains("slideshow-scroller")){n=!1;break}if(!t&&e.contains("work-slide-title")){n=!1;break}l=l.parentElement,t=!1}n?i=[e.screenX,e.screenY]:e.preventDefault()}),this.wrapper.addEventListener("red.argon.mouseUp",e=>{if(null===i)return;let[t,n]=[e.screenX,e.screenY];Math.hypot(t-i[0],n-i[1])<4&&(null!==this.endingAction&&this.endingAction(),this.end(!0))}),this.wrapper.addEventListener("keydown",e=>{"Escape"===e.key&&(e.stopPropagation(),null!==this.endingAction&&this.endingAction(),this.end(!0))}),window.addEventListener("red.argon.pageLayout",this.updateScroller)}begin(e,t,n,i){this.endingAction=i;let l=e.querySelector(".work-entry-image"),s=e.querySelector(".work-entry-title"),o=e.querySelector(".work-entry-meta");switch(this.switchSourceImage(l),this.title.innerHTML=null===s?"":s.innerHTML,this.meta.innerHTML=null===o?"":o.innerHTML,this.body.innerHTML=t.innerHTML,this.visibility){case 0:document.body.appendChild(this.root);case 3:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!n){null!==l&&(l.style.visibility="hidden"),this.visibility=2;break}this.visibility=1,this.root.classList.add("out"),this.requestedFrame=requestAnimationFrame(()=>{this.requestedFrame=null,null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.transitionTimer=setTimeout(()=>{this.root.classList.add("animating"),this.root.classList.remove("out"),this.transformWrapperTo(null),null!==this.sourceImage&&(this.sourceImage.style.visibility="hidden"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.visibility=2},490)},50)});break;case 1:case 2:null!==this.sourceImage&&(this.sourceImage.style.visibility="hidden")}this.updateScroller()}end(e){switch(this.endingAction=null,this.visibility){case 0:case 3:break;case 2:case 1:if(this.root.classList.remove("animating"),null!==this.requestedFrame&&(cancelAnimationFrame(this.requestedFrame),this.requestedFrame=null),null!==this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),!e)return this.switchSourceImage(null),this.visibility=0,void this.root.remove();this.visibility=3,this.root.classList.add("animating"),null!==this.sourceImage&&this.transformWrapperTo(this.sourceImage),this.root.classList.add("out"),this.transitionTimer=setTimeout(()=>{this.transitionTimer=null,this.root.classList.remove("animating"),this.root.classList.remove("out"),this.visibility=0,this.root.remove(),this.transformWrapperTo(null),this.switchSourceImage(null)},450)}}transformWrapperTo(e){if(null===e)return void(this.wrapper.style.transform="");let t=e.getBoundingClientRect(),n=this.transImage.getBoundingClientRect(),i=getComputedStyle(this.wrapper).transform.match(/^matrix\((.+),(.+),(.+),(.+),(.+),(.+)\)$/),[l,s,o,r,a,u]=null===i?[1,0,0,1,0,0]:i.slice(1).map(parseFloat);n={top:n.top/r-u/r,left:n.left/l-a/l,width:n.width/l,height:n.height/r};let d=this.root.getBoundingClientRect(),c=d.left,h=d.top,m=t.width/n.width,f=t.left-c-(n.left-c)*m,p=t.top-h-(n.top-h)*m;this.wrapper.style.transform=`matrix(${m}, 0, 0, ${m}, ${f}, ${p})`,this.wrapper.style.transformOrigin="top left"}switchSourceImage(e){var t;null!==this.sourceImage&&(this.sourceImage.style.visibility="",this.sourceImage=null),null!==e&&(this.sourceImage=e),this.transImage.src=null!==(t=null==e?void 0:e.getAttribute("src"))&&void 0!==t?t:""}}function I(e){let t=parseFloat(getComputedStyle(e,"::before").width)+parseFloat(getComputedStyle(e,"::after").width);return t==t?t:0}const A=/[（［｛〔〈《｟【〖「『]+/,M=/[）］｝〕〉》｠〗】」』．，、。：；！？]+/,k=new RegExp(`${A.source}|${M.source}|…{2,}|—{2,}`,"g"),q=new Set(["BASE","HEAD","LINK","META","TITLE","STYLE","SCRIPT","INPUT","TEXTAREA","IMG","VIDEO","CANVAS","CODE","PRE","MATH","SVG","EMBED"]),x=new Set(["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","BODY","DD","DIV","DL","DT","FIELDSET","FIGURE","FIGCAPTION","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HR","LI","MAIN","NAV","OL","P","SECTION","TABLE","TBODY","TD","TH","TR","THEAD","TFOOT","UL"]);function D(e){e.type=0,e.span=null}function C(e,t){void 0===t&&(t={type:0,span:null}),q.has(e.tagName)||e.classList.contains("cjk-punc")?D(t):(x.has(e.tagName)&&D(t),function(e,t){for(let n=0;n<e.childNodes.length;++n){let i=e.childNodes[n];switch(i.nodeType){case Node.ELEMENT_NODE:C(i,t);break;case Node.TEXT_NODE:let l=F(i.data,t);null!==l&&(n+=l.childNodes.length-1,e.replaceChild(l,i))}}}(e,t))}function F(e,t){if(0===e.length)return null;let n=0;k.lastIndex=0;let i=null,l=null,s=!1;for(;null!==(i=k.exec(e));){null===l&&(l=document.createDocumentFragment());let o=i[0],r=k.lastIndex-o.length;n!==r&&l.append(e.substring(n,r));let a=document.createElement("span");a.textContent=o,a.classList.add("cjk-punc");let u=A.test(o)?1:M.test(o)?-1:0;switch(u){case 1:a.classList.add("hwid","space-before");break;case-1:a.classList.add("hwid","space-after")}l.hasChildNodes()||H(t,u,a),l.append(a),n=k.lastIndex,n===e.length&&(s=!0,t.type=u,t.span=a)}return null!==l&&n!==e.length&&l.append(e.substring(n)),s||D(t),l}function H(e,t,n){-1===t&&-1===e.type?e.span.classList.remove("space-after"):1===t&&1===e.type&&n.classList.remove("space-before")}function N(e,t){let n=document.querySelector(`a[href="${e}"]`);if(null===n)return!1;let i=document.querySelector(`[data-slideshow-for="${e}"]`);return null!==i&&(function(e,t,n,i){null===S&&(S=new SlideshowContext),S.begin(e,t,n,i)}(n,i,t,R),!0)}function R(){let e=location.href,t=e.indexOf("#");var n;if(-1!==t)if(history.state&&history.state.isPrevURLBare){let{scrollTop:e,scrollLeft:t}=document.documentElement;history.back(),(n=()=>{document.documentElement.scrollTo({top:e,left:t,behavior:"instant"})})(),requestAnimationFrame(n),setTimeout(n,0)}else history.pushState({isPrevURLBare:!1},"",e.substring(0,t))}window.addEventListener("red.argon.pageLayout",function(){let e=document.querySelector(".main");if(null===e)return;let t=document.querySelector(".sidebar-background");if(null===t)return;let n=document.querySelector(".page-banner-image"),i=document.documentElement,l=e.classList.contains("wide"),s=NaN;for(let o=0;o<4;++o){let o=i.clientWidth;if(o===s)break;let r=t.offsetWidth,a=getComputedStyle(i),u=parseFloat(a.fontSize),d=getComputedStyle(e),c=parseFloat(d.paddingLeft),h=parseFloat(d.paddingRight),m=o-c-h-r;m=Math.min(40,Math.floor(m/u))*u;let p=(o-(m+c+h))/2+Math.min(r/2,c);p=Math.max(r,Math.floor(p)),l&&(m=o-p-c-h-(p-r),m=Math.min(51,Math.floor(m/u))*u),e.style.width=m+"px",e.style.marginLeft=p-r+"px",null!==n&&(n.style.marginLeft=r-p-c+"px",n.style.width=o-r+"px"),null!==f&&w(),v(o,p+c+m,u),s=o}}),e(()=>{C(document.body),N(location.hash,!1);let e=document.querySelector(".main");null!==e&&function(e){let t=e.querySelectorAll("code");for(let e of t)"PRE"!==e.parentElement.tagName&&y(e,e=>{let t=null,n=0,i=0,l=e.data;for(let e=0;e<l.length;++e){let s=l[e],o=0;switch(o=""===s.trim()?0:s>="a"&&s<="z"?1:s>="A"&&s<="Z"?2:s>="0"&&s<="9"?3:"'"===s||'"'===s?4:5,10*i+o){case 12:case 13:case 23:case 51:case 52:case 53:null===t?t=document.createDocumentFragment():t.appendChild(document.createElement("wbr")),t.append(l.slice(n,e)),n=e}i=o}if(null!==t)return t.appendChild(document.createElement("wbr")),t.append(l.slice(n)),t})}(e)}),window.addEventListener("hashchange",()=>{var e;N(location.hash,!0)||(e=!0,null!==S&&S.end(e))}),window.addEventListener("click",e=>{let t=e.target;for(;null!==t&&"A"!==t.tagName;)t=t.parentElement;if(null===t)return;let n=t.getAttribute("href");if(null!==n&&"#"===n[0]&&N(n,!0)){e.preventDefault();let n=location.href.includes("#"),i=t.href;history.pushState({isPrevURLBare:!n},"",i)}})}();
